<?php class panelBarManager extends Controller { static private $Instance =NULL;private $ssb_data;function __construct(){ global $registry;parent::__construct($registry);require_once DIR_CONFIG.'ssb_library/ssb_data.php';$this->ssb_data=ssb_data::getInstance();} static public function getInstance() { if(self::$Instance==NULL){ $class=__CLASS__;self::$Instance=new $class;} return self::$Instance;} public function getPBMData(){ $tools=$this->ssb_data->getSetting('tools');$data['panel_box'] =$tools['panel_box'];$data['panel_box_css']=$tools['panel_box']['css'];$data['share_button']=$tools['panel_box']['mode']=='button' ? true:false;$data['combination']=$tools['panel_box']['position']['combination'];$data['soc_buttons']=$tools['soc_buttons'];$data['qr_code'] =$tools['qr_code'];$data['url_get_qr'] =$this->url->link('module/superseobox/get_qr');$data['url_countReader']=$this->getCountReaderPath();$data['url_start']=HTTP_SERVER;if (isset($this->request->server['HTTPS']) AND (($this->request->server['HTTPS']=='on') || ($this->request->server['HTTPS']=='1'))) {$data['url_start']=HTTPS_SERVER;} $this->addScript($tools);return $data;} public function addScript($tools){ if($tools['soc_buttons']['status']){ $this->document->addScript( 'catalog/view/javascript/ssb_js/share_qr/jquery.sharrre.min.js');} $this->document->addScript( 'catalog/view/javascript/ssb_js/share_qr/floating-1.12.js');$this->document->addScript( 'catalog/view/javascript/ssb_js/jquery.tipsy.js');$this->document->addScript( 'catalog/view/javascript/ssb_js/share_qr/shar_manager.js');} public function getCountReaderPath(){ if (isset($this->request->server['HTTPS']) AND (($this->request->server['HTTPS']=='on') || ($this->request->server['HTTPS']=='1'))) { $pageURL_forcount='https://'.str_replace('www.','',$_SERVER['HTTP_HOST']).rtrim(dirname($_SERVER['PHP_SELF']),'/.\\').'/';}else{ $pageURL_forcount='http://'.str_replace('www.','',$_SERVER['HTTP_HOST']).rtrim(dirname($_SERVER['PHP_SELF']),'/.\\').'/';} return $pageURL_forcount.'catalog/view/javascript/ssb_js/share_qr/sharrre.php';} } ?>
